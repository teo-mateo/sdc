@model SDC.web.ViewModels.ShelfViewModel

@{
    ViewBag.Title = "Details - " + Model.Name;
}

@section Page_Styles{
    <!--css/style.css-->
<!-- Generic page styles -->
<link rel="stylesheet" href="~/Scripts/jqfu/css/style.css">
<!-- blueimp Gallery styles -->
<!-- <link rel="stylesheet" href="//blueimp.github.io/Gallery/css/blueimp-gallery.min.css">-->
<!-- CSS to style the file input field as button and adjust the Bootstrap progress bars -->
<link rel="stylesheet" href="~/Scripts/jqfu/css/jquery.fileupload.css">
<link rel="stylesheet" href="~/Scripts/jqfu/css/jquery.fileupload-ui.css">
<!-- CSS adjustments for browsers with JavaScript disabled -->
<noscript><link rel="stylesheet" href="~/Scripts/jqfu/css/jquery.fileupload-noscript.css"></noscript>
<noscript><link rel="stylesheet" href="~/Scripts/jqfu/css/jquery.fileupload-ui-noscript.css"></noscript>
}

@section Page_Scripts{

<!--<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>-->
<!-- The jQuery UI widget factory, can be omitted if jQuery UI is already included -->
<script src="~/Scripts/jqfu/js/vendor/jquery.ui.widget.js"></script>

@*<!-- The Templates plugin is included to render the upload/download listings -->
<script src="//blueimp.github.io/JavaScript-Templates/js/tmpl.min.js"></script>
<!-- The Load Image plugin is included for the preview images and image resizing functionality -->
<script src="//blueimp.github.io/JavaScript-Load-Image/js/load-image.all.min.js"></script>
<!-- The Canvas to Blob plugin is included for image resizing functionality -->
<script src="//blueimp.github.io/JavaScript-Canvas-to-Blob/js/canvas-to-blob.min.js"></script>
<!-- Bootstrap JS is not required, but included for the responsive demo navigation -->
<script src="//netdna.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
<!-- blueimp Gallery script -->
<script src="//blueimp.github.io/Gallery/js/jquery.blueimp-gallery.min.js"></script>



<!-- The Iframe Transport is required for browsers without support for XHR file uploads -->
<script src="~/Scripts/jqfu/js/jquery.iframe-transport.js"></script>
<!-- The basic File Upload plugin -->
<script src="~/Scripts/jqfu/js/jquery.fileupload.js"></script>
<!-- The File Upload processing plugin -->
<script src="~/Scripts/jqfu/js/jquery.fileupload-process.js"></script>
<!-- The File Upload image preview & resize plugin -->
<script src="~/Scripts/jqfu/js/jquery.fileupload-image.js"></script>
<!-- The File Upload audio preview plugin -->
<script src="~/Scripts/jqfu/js/jquery.fileupload-audio.js"></script>
<!-- The File Upload video preview plugin -->
<script src="~/Scripts/jqfu/js/jquery.fileupload-video.js"></script>
<!-- The File Upload validation plugin -->
<script src="~/Scripts/jqfu/js/jquery.fileupload-validate.js"></script>
<!-- The File Upload user interface plugin -->
<script src="~/Scripts/jqfu/js/jquery.fileupload-ui.js"></script>
<!-- The main application script -->
<script src="~/Scripts/jqfu/js/main.js"></script>
<!-- The XDomainRequest Transport is included for cross-domain file deletion for IE 8 and IE 9 -->
<!--[if (gte IE 8)&(lt IE 10)]>
<script src="js/cors/jquery.xdr-transport.js"></script>
<![endif]-->
    *@
}

<script type="text/javascript">

    function deleteBook(id) {
        bootbox.confirm(
        "Are you sure you want to delete this book?",
        function (result) {
            if (result) {
                $('#deleteBookId').val(id);
                $('#deleteBookForm').submit();
            }
        });
    }

</script>

<a class="btn btn-primary margin-bottom" onclick="$('#newBookModal').modal('show');">
     Add a book
</a>

<a class="btn btn-default margin-bottom" href="@Url.Action("Index")">Go back</a>

@Html.Partial("Shelves/_AddBookModal", Model)






<div class="box">
    <div class="box-header">
        <div class="box-title">Books in @Model.Name : <strong>@Model.BookCount books.</strong></div>
    </div>
    <div class="box-body">
        <table class="table table-hover table-striped">
            <thead>
                <tr>
                    <td><strong>Title</strong></td>
                    <td><strong>Author(s)</strong></td>
                    <td><strong>Genre</strong></td>
                    <td><strong>Year</strong></td>
                    <td><strong>Publisher</strong></td>
                    <td></td>
                </tr>
            </thead>
 
            @if(Model.BookCount == 0)
            {
                <tr>
                    <td colspan="6">There are no books on this shelf.</td>
                </tr>
            }

            @foreach(var book in Model.Books)
            {
                <tr id="book-@book.Id">
                    <td>
                        <strong>
                            <a href="@Url.Action("ViewBook", "Shelves", new { id = book.Id })">
                                @book.Title
                            </a>    
                        </strong>
                    </td>
                    <td>
                        <ul>
                            @foreach (var author in book.Authors)
                            {
                                <li>
                                    <a href="@Url.Action("ViewAuthor", "Authors", new { id = author.Id })">
                                        @author.Name
                                    </a>
                                </li>
                            }
                        </ul>
                    </td>
                    <td>
                        <ul>
                            @foreach(var genre in book.Genres)
                            {
                                <li>@genre.Name</li>
                            }
                        </ul>
                    </td>
                    <td>
                        @book.Year
                    </td>
                    <td>
                        @((book.Publisher == null) ? "-" : book.Publisher.Name)
                    </td>

                    <td>
                        <a href="#" onclick="deleteBook(@book.Id)">
                            <span class="glyphicon glyphicon-trash"></span>
                            <span>Delete</span>
                        </a>
                        |
                        <a href="#" onclick="editBook(@book.Id);">
                            <span class="glyphicon glyphicon-pencil"></span>
                            <span>Edit</span>
                        </a>
                    </td>
                </tr>
            }

        </table>
        @using (Html.BeginForm("DeleteBook", "Shelves", FormMethod.Post, new { id = "deleteBookForm" }))
        {
            <input type="hidden" id="deleteBookId" name="deleteBookId" />
        }
    </div>
</div>
